<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Pages Carousel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

    <script type="text/javascript" src="assets/json/junior_geeks.json"></script>
    <script type="text/javascript" src="junior_geeks_coding.js"></script>
    <style>
        /* Main container styling */
        .pdf-carousel-container {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%; /* Full width */
            height: 100vh; /* Full height */
            margin: auto; /* Center the div */
            overflow-y: hidden;
            z-index: 1050; /* Ensure it stays above other elements */
            display: flex;
            flex-direction: column; /* Ensure vertical layout */
        }

        /* Hide the container by default */
        .pdf-carousel-container.hidden {
            display: none;
        }

        /* Carousel container to take up available height */
        .carousel-container {
            flex: 1;
            display: flex;
            align-items: center; /* Vertically center carousel */
            justify-content: center; /* Horizontally center carousel */
        }

        /* Carousel items styling */
        .carousel-item img {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-height: 80vh; /* Ensure image fills container height */
            object-fit: contain; /* Ensure image fits nicely inside the div */
        }

        /* Custom styling for carousel controls */
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: #000;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .carousel-control-prev-icon::before,
        .carousel-control-next-icon::before {
            font-size: 30px;
            color: white;
        }

        .carousel-control-prev,
        .carousel-control-next {
            top: 50%;
            transform: translateY(-50%);
            opacity: 1;
            z-index: 1;
        }

        /* Close button styling */
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #dc3545;
            border: none;
            color: white;
            padding: 8px 12px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            z-index: 1060;
        }

        /* Media query for mobile devices */
        @media (max-width: 768px) {
            .pdf-carousel-container {
                width: 100%; /* Full width on mobile */
                height: 100vh; /* Still full height */
            }

            .carousel-item img {
                max-height: 100%; /* Ensure the image fits within the container height */
            }

            .carousel-control-prev-icon,
            .carousel-control-next-icon {
                width: 40px;
                height: 40px;
            }
        }

        /* Overlay to detect outside clicks */
        #pdfOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: transparent;
            display: none; /* Initially hidden */
            z-index: 1040; /* Ensure it's below the container */
        }
    </style>
</head>
<body>

<div class="container">
    <h3>Interactive PDF Viewer</h3>

    <!-- Button to Open Modal for PDF Links -->
    <div class="d-grid">
      <button type="button" class="btn btn-primary btn-block mt-2" data-bs-toggle="modal" data-bs-target="#pdfModal">
        JavaScript Interview Questions
      </button>
    </div>
    <div class="d-grid mt-2">
      <button type="button" class="btn btn-primary btn-block" data-bs-toggle="modal" data-bs-target="#pdfModal">
        Kubernetes Interview Questions
      </button>
    </div>
    <div class="d-grid mt-2">
      <button type="button" class="btn btn-primary btn-block" data-bs-toggle="modal" data-bs-target="#pdfModal">
        Shell Scripting Interview Questions
      </button>
    </div>
    <div class="d-grid mt-2">
      <button type="button" class="btn btn-primary btn-block" data-bs-toggle="modal" data-bs-target="#pdfModal">
        MS Office Interview Questions
      </button>
    </div>

    <!-- Modal for PDF Links -->
    <div class="modal fade" id="pdfModal" tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pdfModalLabel">Available PDFs</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul>
                        <li><a href="#" onclick="openPDF('assets/pdf/junior_geeks/C&C++.pdf'); return false;">C++ PDF</a></li>
                        <li><a href="#" onclick="openPDF('assets/pdf/junior_geeks/canva_designing.pdf'); return false;">Canva Designing PDF</a></li>
                        <li><a href="#" onclick="openPDF('assets/pdf/junior_geeks/computer_science11th_syllabus.pdf'); return false;">Computer Science 11th PDF</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Carousel Container -->
    <div class="pdf-carousel-container hidden" id="pdfCarouselContainer">
        <!-- Close Button -->
        <button class="close-btn" onclick="closePDF()">Close</button>
        
        <!-- Carousel for PDF Pages -->
        <div id="pdfCarousel" class="carousel slide carousel-container" data-bs-ride="carousel">
            <div class="carousel-inner" id="carouselInner">
                <!-- PDF Pages will be loaded here dynamically -->
            </div>

            <!-- Carousel Controls for Navigating Left and Right -->
            <button class="carousel-control-prev" type="button" data-bs-target="#pdfCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#pdfCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>

    <!-- Fullscreen overlay for detecting outside clicks -->
    <div id="pdfOverlay" onclick="closePDF()"></div>
</div>

<div id="modalContainer"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
<script>
    function openPDF(pdfUrl) {
        const carouselInner = document.getElementById('carouselInner');
        const pdfContainer = document.getElementById('pdfCarouselContainer');
        const pdfOverlay = document.getElementById('pdfOverlay');

        // Clear previous content and display the PDF container
        carouselInner.innerHTML = '';
        pdfContainer.classList.remove('hidden');
        pdfOverlay.style.display = 'block'; // Show the overlay

        // Load the PDF using pdf.js
        const loadingTask = pdfjsLib.getDocument(pdfUrl);
        loadingTask.promise.then(function(pdf) {
            const numPages = pdf.numPages;

            // Loop through each page and render it
            for (let pageNum = 1; pageNum <= numPages; pageNum++) {
                pdf.getPage(pageNum).then(function(page) {
                    const scale = 1.5;
                    const viewport = page.getViewport({ scale: scale });

                    // Create a canvas element for this page
                    const canvas = document.createElement('canvas');
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    // Render the page onto the canvas
                    const context = canvas.getContext('2d');
                    const renderContext = {
                        canvasContext: context,
                        viewport: viewport
                    };
                    page.render(renderContext).promise.then(function() {
                        // Add the page to the carousel as a new item
                        const div = document.createElement('div');
                        div.classList.add('carousel-item');
                        if (pageNum === 1) {
                            div.classList.add('active'); // Make the first page active
                        }

                        const img = document.createElement('img');
                        img.src = canvas.toDataURL(); // Convert the canvas to an image
                        img.classList.add('d-block');
                        img.classList.add('w-100');

                        div.appendChild(img);
                        carouselInner.appendChild(div);
                    });
                });
            }
        }, function(reason) {
            console.error(reason);
        });

        // Close the modal when a PDF is opened
        const pdfModal = bootstrap.Modal.getInstance(document.getElementById('pdfModal'));
        if (pdfModal) {
            pdfModal.hide();
        }
    }

    // Function to close the PDF viewer
    function closePDF() {
        document.getElementById('pdfCarouselContainer').classList.add('hidden');
        document.getElementById('pdfOverlay').style.display = 'none'; // Hide the overlay

        // Reopen the modal when closing the PDF viewer
        const pdfModal = new bootstrap.Modal(document.getElementById('pdfModal'));
        pdfModal.show();
    }
</script>

</body>
</html>
